(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t,s){"use strict";s.r(t);s(1);var r=class{constructor(e){if(!e)throw Error("Repository key is required");this.key=e,this.items=[]}add(e){this.items=[e,...this.items],this.syncStorage()}delete(e){this.items=this.items.filter(t=>t.id!==e),this.syncStorage()}find(e){for(let t=0;t<this.items.length;){if(this.items[t].id===e)return this.items[t];t+=1}return null}findAll(){return this.items}indexOf(e){for(let t=0;t<this.items.length;)if(this.items[t].id===e)return t;return-1}get maxId(){return 0===this.items.length?0:Math.max(...this.items.map(e=>e.id))}syncStorage(){if(!window.localStorage)return;const e=this.items.map(e=>e.asJsonSerializable());localStorage.setItem(this.key,JSON.stringify(e))}};class i{constructor(e,t,s){if(!t)throw Error("Invalid id");if(!s)throw Error("Invalid project name");this.createdOn=e||new Date,this.id=t,this.name=s.trim()}asJsonSerializable(){return{createdOn:this.createdOn,id:this.id,name:this.name}}get isDefault(){return"Default"===this.name}static parse(e,t="JSON"){switch(t){case"JSON":{const{createdOn:t,id:s,name:r}=e;return new i(t,s,r)}default:throw Error("Unsupported format for parsing")}}}var n=i;var o=class extends r{constructor(e){super(e);const t=localStorage.getItem(e);if(!t){const e=this.maxId+1;return void this.add(new n(new Date,e,"Default"))}const s=JSON.parse(t);this.items=s.map(e=>n.parse(e))}static get KEY(){return"JUBEI-TODO-APP-PROJECTS-REPOSITORY"}update(e,t){const{index:s}=this.indexOf(e);if(-1===s)return;const{name:r}=t;r&&(this.items[s].name=r)}};var a={URGENT:"Urgent",HIGH:"High",MEDIUM:"Medium",LOW:"Low"};class d{constructor(e,t,s,r,i,n,o){if(!n)throw Error("Invalid Project");if(!o)throw Error("Invalid title");this.createdOn=e||new Date,this.description=t||null,this.dueDate=s||null,this.id=r,this.priority=i||a.LOW,this.projectId=n,this.title=o}asJsonSerializable(){return{createdOn:this.createdOn,description:this.description,dueDate:this.dueDate,id:this.id,priority:this.priority,projectId:this.projectId,title:this.title}}static parse(e,t="JSON"){switch(t){case"JSON":{const{createdOn:t,description:s,dueDate:r,id:i,priority:n,projectId:o,title:a}=e;return new d(t,s,r,i,n,o,a)}default:throw Error("Unsupported format for parsing")}}}var c=d;var l=class extends r{constructor(e){super(e);const t=localStorage.getItem(e);if(!t)return void localStorage.setItem(e,JSON.stringify([]));const s=JSON.parse(t);this.items=s.map(e=>c.parse(e))}static get KEY(){return"JUBEI-TODO-APP-TODOS-REPOSITORY"}update(e,t){const{index:s}=this.indexOf(e);if(-1===s)return;const{description:r,dueDate:i,priority:n,title:o}=t;r&&(this.items[s].description=r),i&&(this.items[s].dueDate=i),n&&(this.items[s].priority=n),o&&(this.items[s].title=o)}where(e){return this.items.filter(t=>t.projectId===e)}};var u=(()=>{let e,t;return{projectsRepository:(e||(e=new o(o.KEY)),e),todosRepository:(t||(t=new l(l.KEY)),t)}})();var m={DATA_STORE_INITIALIZED:"data-store-initialized",PROJECT_CREATED:"project-created",PROJECT_DELETED:"project-deleted",TODO_ITEM_CREATED:"todo-item-created",TODO_ITEM_DELETE:"todo-item-deleted"};var p=(()=>{const e=document.querySelector("#projects-nav"),t=e.querySelector("#addProjectForm"),s=e.querySelector("form"),r=e=>{["text-danger","text-success"].forEach(t=>e.classList.remove(t)),e.innerHTML=""};const i=(e,t,s="success")=>{switch(s){case"error":e.classList.add("text-danger"),e.classList.remove("text-success");break;default:e.classList.add("text-success"),e.classList.remove("text-danger")}e.innerHTML=`${t}`},o=e=>{e.preventDefault();const{localName:t,parentNode:s}=e.target,{id:r}="i"===t?s.dataset:e.target.dataset,i="i"===t?s.parentNode:s;u.projectsRepository.delete(+r),i.parentNode.removeChild(i);const n=new CustomEvent(m.PROJECT_DELETED,{detail:{id:r}});document.dispatchEvent(n)};s.clearForm=function(){const e=this.querySelector("span"),t=this.querySelector("input");return r(e),t.value="",this}.bind(s),t.thenHideForm=function(){return this.classList.add("collapse"),this.classList.remove("show"),this}.bind(t);const a=e=>{const t=document.createElement("span");let s;t.innerText=e.name,e.isDefault||(s=document.createElement("button"),s.classList.add("btn","p-2","btn-delete"),s.innerHTML='<i class="fa fa-trash fa-fw" aria-hidden="true"></i>',s.setAttribute("data-id",e.id),s.addEventListener("click",o));const r=document.createElement("li");return r.appendChild(t),e.isDefault||r.appendChild(s),r.classList.add("bg-white","font-weight-lighter","my-2","p-2","rounded","shadow-lg","project"),r};s.addEventListener("submit",o=>{o.preventDefault();const{value:d}=s.querySelector("#name"),c=s.querySelector("span");r(c);try{const r=u.projectsRepository.maxId+1,o=new n(new Date,r,d);i(c,"Project created"),u.projectsRepository.add(o);const l=e.querySelector("ul");if(l.hasChildNodes()){const{firstChild:e}=l;l.insertBefore(a(o),e)}else l.appendChild(a(o));const p=new CustomEvent(m.PROJECT_CREATED,{detail:{project:o}});document.dispatchEvent(p),setTimeout(()=>{s.clearForm(),t.thenHideForm()},1e3)}catch({message:e}){i(c,e,"error")}});return{initialize:()=>{const t=u.projectsRepository.findAll().map(a),s=document.createElement("ul");s.classList.add("list-unstyled"),e.appendChild(s),t.forEach((e,t)=>setTimeout(()=>{s.appendChild(e)},200*(t+1)))}}})();const h=e=>{const{classes:t,text:s}=e,r=document.createElement("button");return t&&t.length>0&&r.classList.add(...t),r.innerText=s,r},E=e=>{const{classes:t,id:s,placeholder:r,type:i,value:n}=e,o=["form-control","my-2"],a=document.createElement("input");return t&&t.length>0&&o.push(...t),a.classList.add(...o),a.setAttribute("id",s),a.setAttribute("type",i),a.setAttribute("placeholder",r||""),a.value=n||"",a},f=e=>{const{classes:t,id:s,items:r,selected:i}=e,n=["form-control","my-2"];t&&0!==t.length&&n.push(...t);const o=document.createElement("select");return o.classList.add(...n),o.setAttribute("id",s),((e,t="value")=>e&&0===e.length?e:e.sort((e,s)=>{const[r,i]=[e,s].map(e=>e[t].toString());return r<i?-1:r>i?1:0}))(r,"value").forEach(e=>{const{id:t,value:s}=e,r=document.createElement("option");r.text=s,r.value=t,r.value===i&&(r.selected=!0),o.appendChild(r)}),o},y=()=>{const e=document.createElement("form");e.classList.add("pb-5"),e.setAttribute("method","post");const t=(e=>{const t=document.createElement("h6");return t.style.fontWeight="bold",t.innerText=e,t})("Add Todo"),s=E({id:"title",type:"text",placeholder:"Title"}),r=E({id:"description",type:"text",placeholder:"Description"}),i=E({id:"dueDate",type:"date"}),n=u.projectsRepository.findAll().map(e=>({id:e.id,value:e.name})),o=f({id:"projectId",items:n}),d=Object.getOwnPropertyNames(a).map(e=>({id:a[e],value:a[e]})),c=f({id:"priority",items:d}),l=document.createElement("div");l.classList.add("col-12");const m=document.createElement("div");m.classList.add("row");const p=h({classes:["btn","btn-primary","btn-sm","col-5"],text:"Save"}),y=h({classes:["btn","btn-secondary","btn-sm","offset-2","col-5"],text:"Cancel"});return m.append(p,y),l.append(m),e.append(t,s,r,o,i,c,l),e};function v(){const[e,t]=[this.querySelectorAll("input"),this.querySelectorAll("select")];e.forEach(e=>{e.value=""}),t.forEach(e=>{const{id:t}=e;e.value="priority"===t?a.HIGH:1})}function g(e){const t=this,s=Object.create({});return e.forEach(e=>{s[e]=t.querySelector(`#${e}`).value}),s}var b=(()=>{const e=document.querySelector("#key"),t=new Map;t.set(4,{className:"danger",name:a.URGENT}),t.set(3,{className:"primary",name:a.HIGH}),t.set(2,{className:"warning",name:a.MEDIUM}),t.set(1,{className:"success",name:a.LOW});const s=e=>{const{className:s,name:r}=t.get(e),i=document.createElement("span");i.classList.add("badge","badge-light","mr-2"),i.innerText=e;const n=document.createElement("span");n.innerText=r;const o=document.createElement("button");return o.classList.add("btn","btn-block","btn-sm",`btn-${s}`,"font-weight-bold","my-2","text-left"),o.append(i,n),o};return{initialize:()=>{const r=[...t.keys()].sort((e,t)=>t-e).map(s),i=y();i.clearFormFields=v.bind(i),i.queryFormValuesByName=g.bind(i),i.addEventListener("submit",e=>{e.preventDefault();const t=e.target.queryFormValuesByName(["description","dueDate","priority","projectId","title"]),{description:s,dueDate:r,priority:n,projectId:o,title:a}=t;try{const e=u.todosRepository.maxId+1,t=new c(new Date,s,r,e,n,+o,a);u.todosRepository.add(t),i.clearFormFields();const d=new CustomEvent(m.TODO_ITEM_CREATED,{detail:{todoItem:t}});document.dispatchEvent(d)}catch({message:e}){alert(e)}}),e.append(i,...r)},removeProject:t=>{const s=e.querySelector("#projectId");if(!s)return;const r="number"==typeof t?`${t}`:t;for(let e=0;e<s.options.length;){const t=s.options[e];if(t.value===r){s.removeChild(t);break}e+=1}},updateProjectsSelectList:t=>{const s=e.querySelector("#projectId");if(!s)return;const{id:r,name:i}=t,n=document.createElement("option");n.text=i,n.value=r,s.options.add(n)}}})();var w=(()=>{const e=document.querySelector("#todos-list"),t=t=>{u.todosRepository.delete(t);const s=e.querySelector(`#todo-${t}`);s.parentElement.removeChild(s)},s=e=>{const{id:s,priority:r,projectId:i}=e,{name:n}=u.projectsRepository.find(i),o=document.createElement("div"),d=document.createElement("i");d.classList.add("align-self-end","fa","fa-fw","fa-trash-o"),d.dataset.id=s,d.style.cursor="pointer",d.title="Delete Todo",d.addEventListener("click",e=>{const{id:s}=e.target.dataset;t(+s)});const c=document.createElement("i");c.classList.add("fa","fa-fw","fa-pencil"),c.dataset.id=s,c.style.cursor="pointer",c.title="Edit Todo";const l=document.createElement("span"),m=document.createElement("div");l.innerText=n;const[p,h]=(e=>{switch(e){case a.URGENT:return["bg-danger","text-white"];case a.HIGH:return["bg-primary","text-white"];case a.MEDIUM:return["bg-warning","text-dark"];default:return["bg-success","text-dark"]}})(r);return m.classList.add("card-footer","d-flex","justify-content-between",`${p}`,"font-weight-bold",`${h}`),o.append(c,d),m.append(l,o),m},r=e=>{const{description:t,dueDate:s,id:r}=e,i=(({id:e,title:t})=>{const s=document.createElement("span");s.innerText=t;const r=document.createElement("icon");r.classList.add("fa","fa-chevron-circle-left"),r.setAttribute("aria-controls",`shell-todo-${e}`),r.setAttribute("aria-expanded",!1),r.setAttribute("data-target",`#shell-todo-${e}`),r.setAttribute("data-toggle","collapse"),r.style.fontSize="smaller",r.style.cursor="pointer",r.addEventListener("click",e=>{const{target:t}=e;[...t.classList].includes("fa-chevron-circle-left")?(t.classList.remove("fa-chevron-circle-left"),t.classList.add("fa-chevron-circle-down")):(t.classList.remove("fa-chevron-circle-down"),t.classList.add("fa-chevron-circle-left"))});const i=document.createElement("h2");return i.classList.add("d-flex","justify-content-between"),i.append(s,r),i})(e),n=document.createElement("div");n.classList.add("collapse"),n.setAttribute("id",`shell-todo-${r}`);const o=document.createElement("h6");if(o.classList.add("font-weight-bold","text-center","text-primary"),o.innerText=`Due on: ${s}`,n.appendChild(o),t){const e=document.createElement("p");e.innerText=t,n.appendChild(e)}const a=document.createElement("div");return a.classList.add("card-body"),a.append(i,n),a},i=t=>{const i=(e=>{const{id:t}=e,i=document.createElement("div");i.classList.add("col-4","mb-3","todo"),i.setAttribute("id",`todo-${t}`);const n=document.createElement("div");n.classList.add("card","border-bottom","shadow");const o=r(e),a=s(e);return n.append(o,a),i.appendChild(n),i})(t),n=e.firstChild;n?e.insertBefore(i,n):e.appendChild(i)};return{addTodoItem:i,initialize:()=>u.todosRepository.findAll().forEach((e,t)=>setTimeout(()=>{i(e)},200*(t+1))),removeTodosAssociatedWith:e=>u.todosRepository.where(e).map(e=>e.id).forEach(t)}})();document.addEventListener("DOMContentLoaded",()=>{p.initialize(),b.initialize(),w.initialize()}),document.addEventListener(m.PROJECT_CREATED,e=>{const{project:t}=e.detail;b.updateProjectsSelectList(t)}),document.addEventListener(m.PROJECT_DELETED,e=>{const{id:t}=e.detail;b.removeProject(t),w.removeTodosAssociatedWith(+t)}),document.addEventListener(m.TODO_ITEM_CREATED,e=>{const{todoItem:t}=e.detail;w.addTodoItem(t)})},function(e,t){}],[[0,2,1]]]);