(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t,s){"use strict";s.r(t);s(1);var r=class{constructor(e){if(!e)throw Error("Repository key is required");this.key=e,this.items=[]}add(e){this.items=[e,...this.items],this.syncStorage()}delete(e){this.items=this.items.filter(t=>t.id!==e),this.syncStorage()}find(e){for(let t=0;t<this.items.length;){if(this.items[t].id===e)return this.items[t];t+=1}return null}findAll(){return this.items}indexOf(e){for(let t=0;t<this.items.length;){if(this.items[t].id===e)return t;t+=1}return-1}get maxId(){return 0===this.items.length?0:Math.max(...this.items.map(e=>e.id))}syncStorage(){if(!window.localStorage)return;const e=this.items.map(e=>e.asJsonSerializable());localStorage.setItem(this.key,JSON.stringify(e))}};class i{constructor(e,t,s){if(!t)throw Error("Invalid id");if(!s)throw Error("Invalid project name");this.createdOn=e||new Date,this.id=t,this.name=s.trim()}asJsonSerializable(){return{createdOn:this.createdOn,id:this.id,name:this.name}}get isDefault(){return"Default"===this.name}static parse(e,t="JSON"){switch(t){case"JSON":{const{createdOn:t,id:s,name:r}=e;return new i(t,s,r)}default:throw Error("Unsupported format for parsing")}}}var n=i;var o=class extends r{constructor(e){super(e);const t=localStorage.getItem(e);if(!t){const e=this.maxId+1;return void this.add(new n(new Date,e,"Default"))}const s=JSON.parse(t);this.items=s.map(e=>n.parse(e))}static get KEY(){return"JUBEI-TODO-APP-PROJECTS-REPOSITORY"}update(e,t){const{index:s}=this.indexOf(e);if(-1===s)return;const{name:r}=t;r&&(this.items[s].name=r)}};var a={URGENT:"Urgent",HIGH:"High",MEDIUM:"Medium",LOW:"Low"};class d{constructor(e,t,s,r,i,n,o){if(!n)throw Error("Invalid Project");if(!o)throw Error("Invalid title");this.createdOn=e||new Date,this.description=t||null,this.dueDate=s||null,this.id=r,this.priority=i||a.LOW,this.projectId=n,this.title=o}asJsonSerializable(){return{createdOn:this.createdOn,description:this.description,dueDate:this.dueDate,id:this.id,priority:this.priority,projectId:this.projectId,title:this.title}}static parse(e,t="JSON"){switch(t){case"JSON":{const{createdOn:t,description:s,dueDate:r,id:i,priority:n,projectId:o,title:a}=e;return new d(t,s,r,i,n,o,a)}default:throw Error("Unsupported format for parsing")}}}var c=d;var l=class extends r{constructor(e){super(e);const t=localStorage.getItem(e);if(!t)return void localStorage.setItem(e,JSON.stringify([]));const s=JSON.parse(t);this.items=s.map(e=>c.parse(e))}static get KEY(){return"JUBEI-TODO-APP-TODOS-REPOSITORY"}update(e,t){const s=this.indexOf(e);if(-1===s)return;const{description:r,dueDate:i,priority:n,projectId:o,title:a}=t;if(!o)throw Error("Invalid project ID");r&&(this.items[s].description=r),i&&(this.items[s].dueDate=i),n&&(this.items[s].priority=n),a&&(this.items[s].title=a),this.items[s].projectId=+o,this.syncStorage()}where(e){return this.items.filter(t=>t.projectId===e)}};var u=(()=>{let e,t;return{projectsRepository:(e||(e=new o(o.KEY)),e),todosRepository:(t||(t=new l(l.KEY)),t)}})();var p={DATA_STORE_INITIALIZED:"data-store-initialized",PROJECT_CREATED:"project-created",PROJECT_DELETED:"project-deleted",TODO_ITEM_CREATED:"todo-item-created",TODO_ITEM_DELETE:"todo-item-deleted"};var m=(()=>{const e=document.querySelector("#projects-nav"),t=e.querySelector("#addProjectForm"),s=e.querySelector("form"),r=e=>{["text-danger","text-success"].forEach(t=>e.classList.remove(t)),e.innerHTML=""};const i=(e,t,s="success")=>{switch(s){case"error":e.classList.add("text-danger"),e.classList.remove("text-success");break;default:e.classList.add("text-success"),e.classList.remove("text-danger")}e.innerHTML=`${t}`},o=e=>{e.preventDefault();const{localName:t,parentNode:s}=e.target,{id:r}="i"===t?s.dataset:e.target.dataset,i="i"===t?s.parentNode:s;u.projectsRepository.delete(+r),i.parentNode.removeChild(i);const n=new CustomEvent(p.PROJECT_DELETED,{detail:{id:r}});document.dispatchEvent(n)};s.clearForm=function(){const e=this.querySelector("span"),t=this.querySelector("input");return r(e),t.value="",this}.bind(s),t.thenHideForm=function(){return this.classList.add("collapse"),this.classList.remove("show"),this}.bind(t);const a=e=>{const t=document.createElement("span");let s;t.innerText=e.name,e.isDefault||(s=document.createElement("button"),s.classList.add("btn","p-2","btn-delete"),s.innerHTML='<i class="fa fa-trash fa-fw" aria-hidden="true"></i>',s.setAttribute("data-id",e.id),s.addEventListener("click",o));const r=document.createElement("li");return r.appendChild(t),e.isDefault||r.appendChild(s),r.classList.add("bg-white","font-weight-lighter","my-2","p-2","rounded","shadow-lg","project"),r};s.addEventListener("submit",o=>{o.preventDefault();const{value:d}=s.querySelector("#name"),c=s.querySelector("span");r(c);try{const r=u.projectsRepository.maxId+1,o=new n(new Date,r,d);i(c,"Project created"),u.projectsRepository.add(o);const l=e.querySelector("ul");if(l.hasChildNodes()){const{firstChild:e}=l;l.insertBefore(a(o),e)}else l.appendChild(a(o));const m=new CustomEvent(p.PROJECT_CREATED,{detail:{project:o}});document.dispatchEvent(m),setTimeout(()=>{s.clearForm(),t.thenHideForm()},1e3)}catch({message:e}){i(c,e,"error")}});return{initialize:()=>{const t=u.projectsRepository.findAll().map(a),s=document.createElement("ul");s.classList.add("list-unstyled"),e.appendChild(s),t.forEach((e,t)=>setTimeout(()=>{s.appendChild(e)},200*(t+1)))}}})();const h=e=>{const{classes:t,text:s}=e,r=document.createElement("button");return t&&t.length>0&&r.classList.add(...t),r.innerText=s,r},f=e=>{const{classes:t,id:s,placeholder:r,type:i,value:n}=e,o=["form-control","my-2"],a=document.createElement("input");return t&&t.length>0&&o.push(...t),a.classList.add(...o),a.setAttribute("id",s),a.setAttribute("type",i),a.setAttribute("placeholder",r||""),a.value=n||"",a},E=e=>{const{classes:t,id:s,items:r,selected:i}=e,n=["form-control","my-2"];t&&0!==t.length&&n.push(...t);const o=document.createElement("select");return o.classList.add(...n),o.setAttribute("id",s),((e,t="value")=>e&&0===e.length?e:e.sort((e,s)=>{const[r,i]=[e,s].map(e=>e[t].toString());return r<i?-1:r>i?1:0}))(r,"value").forEach(e=>{const{text:t,value:s}=e,r=document.createElement("option");r.text=t,r.value=s,r.value===i&&(r.selected=!0),o.appendChild(r)}),o},y=e=>{const t=document.createElement("h6");return t.style.fontWeight="bold",t.innerText=e,t},v=()=>{const e=document.createElement("form");return e.classList.add("pb-5"),e.setAttribute("method","post"),e},g=()=>{const e=document.createElement("div");e.classList.add("col-12");const t=document.createElement("div");t.classList.add("row");const s=h({classes:["btn","btn-primary","btn-sm","col-5"],text:"Save"});s.setAttribute("value","Save");const r=h({classes:["btn","btn-secondary","btn-sm","offset-2","col-5"],text:"Cancel"});return r.setAttribute("value","Cancel"),t.append(s,r),e.append(t),e};function b(){const[e,t]=[this.querySelectorAll("input"),this.querySelectorAll("select")];e.forEach(e=>{e.value=""}),t.forEach(e=>{const{id:t}=e;e.value="priority"===t?a.HIGH:1})}function w(e){const t=this,s=Object.create({});return e.forEach(e=>{s[e]=t.querySelector(`#${e}`).value}),s}var L=(()=>{const e=document.querySelector("#key"),t=new Map;t.set(4,{className:"danger",name:a.URGENT}),t.set(3,{className:"primary",name:a.HIGH}),t.set(2,{className:"warning",name:a.MEDIUM}),t.set(1,{className:"success",name:a.LOW});const s=e=>{const{className:s,name:r}=t.get(e),i=document.createElement("span");i.classList.add("badge","badge-light","mr-2"),i.innerText=e;const n=document.createElement("span");n.innerText=r;const o=document.createElement("button");return o.classList.add("btn","btn-block","btn-sm",`btn-${s}`,"font-weight-bold","my-2","text-left"),o.append(i,n),o};return{initialize:()=>{const r=[...t.keys()].sort((e,t)=>t-e).map(s),i=(()=>{const e=v(),t=y("Add Todo"),s=f({id:"title",type:"text",placeholder:"Title"}),r=f({id:"description",type:"text",placeholder:"Description"}),i=f({id:"dueDate",type:"date"}),n=u.projectsRepository.findAll().map(e=>({text:e.name,value:e.id})),o=E({id:"projectId",items:n}),d=Object.getOwnPropertyNames(a).map(e=>({text:a[e],value:a[e]})),c=E({id:"priority",items:d}),l=g();return e.append(t,s,r,o,i,c,l),e})();i.clearFormFields=b.bind(i),i.queryFormValuesByName=w.bind(i),i.addEventListener("submit",e=>{e.preventDefault();const t=e.target.queryFormValuesByName(["description","dueDate","priority","projectId","title"]),{description:s,dueDate:r,priority:n,projectId:o,title:a}=t;try{const e=u.todosRepository.maxId+1,t=new c(new Date,s,r,e,n,+o,a);u.todosRepository.add(t),i.clearFormFields();const d=new CustomEvent(p.TODO_ITEM_CREATED,{detail:{todoItem:t}});document.dispatchEvent(d)}catch({message:e}){alert(e)}}),e.append(i,...r)},removeProject:t=>{const s=e.querySelector("#projectId");if(!s)return;const r="number"==typeof t?`${t}`:t;for(let e=0;e<s.options.length;){const t=s.options[e];if(t.value===r){s.removeChild(t);break}e+=1}},updateProjectsSelectList:t=>{const s=e.querySelector("#projectId");if(!s)return;const{id:r,name:i}=t,n=document.createElement("option");n.text=i,n.value=r,s.options.add(n)}}})();var T=(()=>{const e=document.querySelector("#todos-list"),t=t=>{t.preventDefault();const{id:s}=t.target.dataset,r=d(u.todosRepository.find(+s)),i=e.querySelector(`#todo-${s}`);e.replaceChild(r,i)},s=t=>{t.preventDefault();const s=t.target,r=s.querySelector('input[type="hidden"]').value,i=s.queryFormValuesByName(["description","dueDate","priority","projectId","title"]);try{u.todosRepository.update(+r,i);const t=d(u.todosRepository.find(+r)),s=e.querySelector(`#todo-${r}`);e.replaceChild(t,s)}catch({message:e}){alert(e)}},r=r=>{const i=(e=>{const{description:t,dueDate:s,id:r,priority:i,projectId:n,title:o}=e,d=v(),c=y("Edit Todo Item");c.classList.add("text-center");const l=document.createElement("input");l.setAttribute("type","hidden"),l.value=r;const p=f({id:"title",type:"text",placeholder:"Title"});p.value=o;const m=f({id:"description",type:"text",placeholder:"Description"});m.value=t;const h=f({id:"dueDate",type:"date"});h.value=s;const b=u.projectsRepository.findAll().map(e=>({text:e.name,value:e.id})),w=E({id:"projectId",items:b,selected:`${n}`}),L=Object.getOwnPropertyNames(a).map(e=>({text:a[e],value:a[e]})),T=E({id:"priority",items:L,selected:i}),D=g();return d.append(c,l,p,m,h,w,T,D),d})(u.todosRepository.find(r)),n=e.querySelector(`#shell-todo-${r}`);for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(i);const[o,d]=["Save","Cancel"].map(e=>n.querySelector(`button[value="${e}"]`));d.dataset.id=r,o.dataset.id=r,d.addEventListener("click",t),i.queryFormValuesByName=w.bind(i),i.addEventListener("submit",s)},i=t=>{u.todosRepository.delete(t);const s=e.querySelector(`#todo-${t}`);s.parentElement.removeChild(s)},n=e=>{const{id:t,priority:s,projectId:n}=e,{name:o}=u.projectsRepository.find(n),d=document.createElement("div"),c=document.createElement("i");c.classList.add("align-self-end","fa","fa-fw","fa-trash-o"),c.dataset.id=t,c.style.cursor="pointer",c.title="Delete Todo",c.addEventListener("click",e=>{const{id:t}=e.target.dataset;i(+t)});const l=document.createElement("i");l.classList.add("fa","fa-fw","fa-pencil"),l.dataset.id=t,l.style.cursor="pointer",l.title="Edit Todo",l.addEventListener("click",e=>{const{id:t}=e.target.dataset;r(+t)});const p=document.createElement("span"),m=document.createElement("div");p.innerText=o;const[h,f]=(e=>{switch(e){case a.URGENT:return["bg-danger","text-white"];case a.HIGH:return["bg-primary","text-white"];case a.MEDIUM:return["bg-warning","text-dark"];default:return["bg-success","text-dark"]}})(s);return m.classList.add("card-footer","d-flex","justify-content-between",`${h}`,"font-weight-bold",`${f}`),d.append(l,c),m.append(p,d),m},o=e=>{const{description:t,dueDate:s,id:r}=e,i=(({id:e,title:t})=>{const s=document.createElement("span");s.innerText=t;const r=document.createElement("icon");r.classList.add("fa","fa-chevron-circle-left"),r.setAttribute("aria-controls",`shell-todo-${e}`),r.setAttribute("aria-expanded",!1),r.setAttribute("data-target",`#shell-todo-${e}`),r.setAttribute("data-toggle","collapse"),r.style.fontSize="smaller",r.style.cursor="pointer",r.addEventListener("click",e=>{const{target:t}=e;[...t.classList].includes("fa-chevron-circle-left")?(t.classList.remove("fa-chevron-circle-left"),t.classList.add("fa-chevron-circle-down")):(t.classList.remove("fa-chevron-circle-down"),t.classList.add("fa-chevron-circle-left"))});const i=document.createElement("h2");return i.classList.add("d-flex","justify-content-between"),i.append(s,r),i})(e),n=document.createElement("div");n.classList.add("collapse"),n.setAttribute("id",`shell-todo-${r}`);const o=document.createElement("h6");if(o.classList.add("font-weight-bold","text-center","text-primary"),o.innerText=`Due on: ${s}`,n.appendChild(o),t){const e=document.createElement("p");e.innerText=t,n.appendChild(e)}const a=document.createElement("div");return a.classList.add("card-body"),a.append(i,n),a};function d(e){const{id:t}=e,s=document.createElement("div");s.classList.add("col-4","mb-3","todo"),s.setAttribute("id",`todo-${t}`);const r=document.createElement("div");r.classList.add("card","border-bottom","shadow");const i=o(e),a=n(e);return r.append(i,a),s.appendChild(r),s}const c=t=>{const s=d(t),r=e.firstChild;r?e.insertBefore(s,r):e.appendChild(s)};return{addTodoItem:c,initialize:()=>u.todosRepository.findAll().forEach((e,t)=>setTimeout(()=>{c(e)},200*(t+1))),removeTodosAssociatedWith:e=>u.todosRepository.where(e).map(e=>e.id).forEach(i)}})();document.addEventListener("DOMContentLoaded",()=>{m.initialize(),L.initialize(),T.initialize()}),document.addEventListener(p.PROJECT_CREATED,e=>{const{project:t}=e.detail;L.updateProjectsSelectList(t)}),document.addEventListener(p.PROJECT_DELETED,e=>{const{id:t}=e.detail;L.removeProject(t),T.removeTodosAssociatedWith(+t)}),document.addEventListener(p.TODO_ITEM_CREATED,e=>{const{todoItem:t}=e.detail;T.addTodoItem(t)})},function(e,t){}],[[0,2,1]]]);